<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	line-height:106%;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
a:link, span.MsoHyperlink
	{color:#0563C1;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:#954F72;
	text-decoration:underline;}
.MsoChpDefault
	{font-size:12.0pt;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
.auto-style1 {
	text-align: center;
	line-height: 150%;
	margin-top: 0;
	margin-bottom: 0;
}
.auto-style2 {
	text-decoration: underline;
	font-family: "Times New Roman", Times, serif;
}
.auto-style3 {
	font-size: 14pt;
	font-family: "Times New Roman", Times, serif;
}
.auto-style6 {
	font-size: 14pt;
	line-height: 150%;
	margin-top: 0;
	margin-bottom: 8px;
	font-family: "Times New Roman", Times, serif;
}
.auto-style8 {
	font-size: 14pt;
	line-height: 150%;
	margin-top: 0;
	margin-bottom: 0;
	text-decoration: underline;
	margin-left: 40px;
	font-family: "Times New Roman", Times, serif;
}
.auto-style9 {
	font-size: 14pt;
	line-height: 150%;
	margin-top: 0;
	margin-bottom: 0;
}
.auto-style10 {
	font-size: 14pt;
	font-weight: bold;
	line-height: 150%;
	margin-top: 0;
	margin-bottom: 0;
	font-family: "Times New Roman", Times, serif;
}
.auto-style12 {
	font-size: 14pt;
	line-height: 150%;
	margin-top: 0;
	margin-bottom: 0;
	font-family: "Times New Roman", Times, serif;
}
.auto-style13 {
	font-family: "Times New Roman", Times, serif;
}
-->
</style>

<title>Appendix C</title>

</head>

<body lang=EN-AU link="#0563C1" vlink="#954F72">

<div class=WordSection1>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><b><i><span
style='font-size:38.0pt;line-height:106%;color:#2F5597'>ClimPACT2</span></i></b></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><b><span
style='font-size:19.0pt;line-height:106%'>Appendix C: Quality Control (QC)
diagnostics</span></b></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:16.0pt;line-height:106%'>&lt; <a href="appendixB.htm">Prev.</a> | 
<a href="../ClimPACT2_user_guide.htm">Home</a> | <a href="appendixD.htm">Next</a> &gt;</span></p>

<p class=MsoNormal>&nbsp;</p>

	<p class=auto-style8>Preface</p>
	<p class=auto-style12>This appendix describes the output of the QC 
	functionality present in ClimPACT2. While the QC checks performed by 
	ClimPACT2 are reasonably extensive they do not guarantee that all errors 
	will be detected. Furthermore, a separate category of quality issues, that 
	of <em>homogeneity</em>, often occurs in station data and ClimPACT2 does no 
	checking for this. Thus it is advised that, if the user is analysing 
	observations (as opposed to model data) that they be sure of the quality of 
	their data before using ClimPACT2, or, that they utilise additional checks 
	for homogeneity in addition to the QC checks performed by ClimPACT2 (and 
	described in this appendix).
	<a href="http://etccdi.pacificclimate.org/software.shtml">RHtests</a> is one 
	program that performs homogeneity tests. It is freely available, 
	easy to use and is also built on the R programming language.</p>
	<p class=auto-style12>&nbsp;</p>
	<p class=auto-style12><em>The text in this appendix is adapted from text written by
Enric Aguilar and Marc Prohom for the R functions they created to perform
quality control, which have been integrated into the ClimPACT2 software with 
their permission.</em></p>
	<p class=auto-style12>&nbsp;</p>
	<p class=auto-style9><span class="auto-style13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	</span>
	<span class="auto-style2">C.1 Overview</span><span class="auto-style13">&nbsp;</span></p>
	<p class=auto-style12>Once the user selects ‘PROCESS AND QUALITY CONTROL’
ClimPACT2 will take a minute or two to calculate thresholds and perform quality
control checks. At the end of this process a dialogue box will appear telling
the user to check the /qc subdirectory created in the directory where their
	station text file is stored.</p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>The /qc folder contains the following files (where
“mystation” refers to the name of the user’s station file):</p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>7 .pdf files, with graphical information on data quality:</p>

	<ul>
		<li>
		<p class=auto-style12>mystation_tminPLOT.pdf</p>
		</li>
		<li>
		<p class=auto-style12>mystation_tmaxPLOT.pdf</p>
		</li>
		<li>
		<p class=auto-style12>mystation_dtrPLOT.pdf</p>
		</li>
		<li>
		<p class=auto-style12>&nbsp;mystation_prcpPLOT.pdf</p>
		</li>
		<li>
		<p class=auto-style12>&nbsp;mystation_boxes.pdf</p>
		</li>
		<li>
		<p class=auto-style12>&nbsp;mystation_boxseries.pdf</p>
		</li>
		<li>
		<p class=auto-style12>&nbsp;mystation_rounding.pdf</p>
		</li>
	</ul>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>9 .csv files with numerical information on data quality</p>

	<ul>
		<li>
		<p class=auto-style12>mystation_duplicates.csv</p>
		</li>
		<li>
		<p class=auto-style12>&nbsp;mystation_outliers.csv</p>
		</li>
		<li>
		<p class=auto-style12>&nbsp;mystation_tmaxmin.csv</p>
		</li>
		<li>
		<p class=auto-style12>mystation_tx_flatline.csv</p>
		</li>
		<li>
		<p class=auto-style12>mystation_tn_flatline.csv</p>
		</li>
		<li>
		<p class=auto-style12>mystation_toolarge.csv</p>
		</li>
		<li>
		<p class=auto-style12>mystation_tx_jumps.csv</p>
		</li>
		<li>
		<p class=auto-style12>mystation_tn_jumps.csv</p>
		</li>
		<li>
		<p class=auto-style12>mystation_temp_nastatistics.csv</p>
		</li>
	</ul>

<p class=auto-style12>&nbsp;</p>
	<p class=auto-style9><span class="auto-style13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	</span>
	<span class="auto-style2">C.2 File descriptions</span><span class="auto-style13">&nbsp;</span></p>

<p class=auto-style10>mystation_tminPLOT.pdf</p>

<p class=auto-style10>mystation_tmaxPLOT.pdf</p>

<p class=auto-style10>mystation_dtrPLOT.pdf</p>

<p class=auto-style10>mystation_prcpPLOT.pdf</p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>These files contain simple plots of the daily time-series of
minimum temperature, maximum temperature, diurnal temperature range and
precipitation, respectively. This allows the user to view the data and identify
obvious problems by eye such as missing data (indicated by red circles) or
unrealistic values.</p>

<p class=auto-style12>Below is an example for tmax.</p>
	<p class=auto-style1>
	<img alt="tmax" class="auto-style3" height="486" src="../images/tmax_plot.png" width="973"></p>

<p class=auto-style10>mystation_boxes.pdf</p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>This file identifies potential outliers based on the
interquartilic (IQR). The IQR is defined as the difference between the 75th
(p75) and the 25th (p25) percentiles. As can be seen in the example below, the
mystation_boxes.pdf file contains boxplots of temperature and precipitation
data flagging as outliers (round circles) all those temperature values falling
outside a range defined by p25 – 3 interquartilic ranges (lower bound) and p75
+ 3 interquartilic ranges (upper bound). For precipitation, 5 IQR are used. </p>

<p class=auto-style9 align=center style='text-align:center'><span
style='line-height:106%'>
<img border=0 width=737 height=708 id="Picture 1"
src="../images/QC_boxes.png" class="auto-style13"></span></p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>The values identified by this graphical quality control, are
sent to a .csv file, mystation_outliers.csv. This file lists the outliers
grouped under the variable that produced the inclusion of the record in the
file and specifying the margin (upper bound or lower bound) that is surpassed.
So, under ‘Prec up’ appear those values that represent a precipitation outlier;
under ‘TX up’ are those that represent a maximum temperature higher than
p75+3*IQR; under ‘TX low’ are outliers that represent an observation lower than
p25-3*IQR. The explanation given for TX, also applies to TN and DTR. The
advantage of this approach is that the detection of this percentile based
outliers is not affected by the presence of larger outliers, so ONE RUN OF THE
PROCESS IS ENOUGH! </p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>Date    Prec     TX       TN       DTR</p>

<p class=auto-style12>Prec up                                                </p>

<p class=auto-style12>2/01/1951        31.8     14.3     10.2     4.1</p>

<p class=auto-style12>12/01/1961      47.5     23.4     11.4     12</p>

<p class=auto-style12>5/04/1963        42.8     19.2     13.6     5.6</p>

<p class=auto-style12>18/04/1967      29.1     20.2     11.8     8.4</p>

<p class=auto-style12>19/04/1969      28.2     27.7     17.9     9.8</p>

<p class=auto-style12>19/04/1973      53.6     14.8     11.1     3.7</p>

<p class=auto-style12>21/11/1991      55.9     11.4     7.8       3.6</p>

<p class=auto-style12>11/11/1995      32.1     18.4     13.5     4.9</p>

<p class=auto-style12>1/12/2000        31.6     18.6     12.6     6</p>

<p class=auto-style12>31/12/2001      32.1     16        9.4       6.6</p>

<p class=auto-style12>15/12/2005      30.2     22.1     13.3     8.8</p>

<p class=auto-style12>TX up                                      </p>

<p class=auto-style12>TX low                                                </p>

<p class=auto-style12>TN up                                      </p>

<p class=auto-style12>TN low                                                </p>

<p class=auto-style12>30/10/1972      2.5       -11.2    -23.4    12.2</p>

<p class=auto-style12>31/10/1972      4.3       -4.8      -24.8    20</p>

<p class=auto-style12>DTR up                                               </p>

<p class=auto-style12>DTR low                                             </p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style10>mystation_boxseries.pdf</p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>The graphic file boxseries.pdf (which does not have a
numerical counterpart) produces annual boxplots. This file is useful to have a
panoramic view of the series and be alerted of parts of the series which can be
problematic (see values around 1984 in the example figure below).</p>

<p class=auto-style9 align=center style='text-align:center'><span
style='line-height:106%'>
<img border=0 width=751 height=732 id="Picture 2"
src="../images/QC_boxseries.png" class="auto-style13"></span></p>

<p class=auto-style10>mystation_rounding.pdf</p>

<p class=auto-style12>This file looks at rounding problems by plotting the
frequency of values after each decimal point. It shows how frequently each of
the 10 possible values (.0 to .9) appears. It is expected that .0 and .5 will
be more frequent (although there is no statistical reason for this!). </p>

<p class=auto-style9 align=center style='text-align:center'><span
style='line-height:106%'>
<img border=0 width=677 height=659 id="Picture 3"
src="../images/QC_rounding.png" class="auto-style13"></span></p>

<p class=auto-style10>mystation_tn_flatline.csv</p>

<p class=auto-style10>mystation_tx_flatline.csv</p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>The mystation_tn_flatline.csv and mystation_tx_flatline.csv
files report occurrences of 4 or more equal consecutive values in,
respectively, TX and TN. A line for each sequence of 4 or more consecutive
equal values is generated. In the example below all sequences are 4 values long
(i.e. each corresponding value has been repeated 3 extra times). The date
specified belongs to the end of the sequence.</p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>Date    TX       Number of duplicates</p>

<p class=auto-style12>4/09/1937        18        3</p>

<p class=auto-style12>28/11/1937      16.9     3</p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>Looking at the data, the first sequence identified by the QC
test is shown below.</p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>1937    9          1          0          16.4     11.6</p>

<p class=auto-style12>1937    9          2          0          18        10.2</p>

<p class=auto-style12>1937    9          3          0          18        8.6</p>

<p class=auto-style12>1937    9          4          0          18        7 </p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style10>mystation_duplicates.csv</p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>The file mystation_duplicates.csv includes all dates which
appear more than once in a datafile. In the listing below, one can see that
1958/08/26 occurs twice, and thus will be reported in mystation_duplicates.csv.</p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>1951 8 24</p>

<p class=auto-style12>1951 8 25</p>

<p class=auto-style12>1951 8 26</p>

<p class=auto-style12>1951 8 26</p>

<p class=auto-style12>1951 8 28</p>

<p class=auto-style12>1951 8 29</p>

<p class=auto-style12>1951 8 30</p>

<p class=auto-style12>1951 8 31</p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style10>mystation_toolarge.csv</p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>The file mystation_toolarge.csv reports precipitation values
exceeding 200 mm (this and any other threshold can be easily reconfigured
before execution) and temperature values exceeding 50 ºC. </p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style10>mystation_tx_jumps.csv</p>

<p class=auto-style10>mystation_tn_jumps.csv</p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>The files mystation_tx_jumps.csv and mystation_tn_jumps.csv
will list those records where the</p>

<p class=auto-style12>temperature difference with the previous day is greater or
equal than 20 ºC. </p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style10>mystation_tmaxmin.csv</p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>The mystation_tmaxmin.csv file, records all those dates
where maximum temperature is lower than minimum temperature. </p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style10>mystation_temp_nastatistics.csv</p>

<p class=auto-style12>&nbsp;</p>

<p class=auto-style12>This file lists the number of missing values that exists for
each variable (TX, TN, PR) for each year.</p>
	<p class=auto-style6>&nbsp;</p>
	<p class=auto-style6>&nbsp;</p>

</div>

</body>

</html>
